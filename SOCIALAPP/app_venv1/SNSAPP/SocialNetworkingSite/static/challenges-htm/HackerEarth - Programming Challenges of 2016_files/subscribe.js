// URL for subscribing to an event
var SUBSCRIBE_URL="/event-subscription/AJAX/subscribe/",SUBSCRIBED_MESSAGE='<span class="dark challenge-2-hide">You have been registered, and an email has been sent.</span>',ERROR_MSG='<p class="errorlist">Please enter a valid email.</p>',re=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,ResponseCode={OK:"OK",ERROR:"ERROR"};$(document).ready(function(){$(".subscribe-form").live("submit",function(){var a=$(this),b=a.attr("data-source"),c=a.find("input[type=submit]"),d=a.serialize(),e=a.find("input[type=text]");if(e.length){var f=e.val();if(!f.match(re))return c.next().attr("class")!="errorlist"&&c.after(ERROR_MSG),!1}else if(b=="challenge-page")var g="";else a.html(SUBSCRIBED_MESSAGE);$.ajax({data:d,type:"POST",url:SUBSCRIBE_URL,dataType:"json",success:function(a){if(a["status"]==ResponseCode.OK){var b="<p>"+a.message+"</p>";a.url&&(window.location.href=a.url)}else{var b="<p>"+a.message+"</p>";c.after(b)}}});if(f!=undefined){var h=window.location.pathname,i="/signup/?email="+f+"&next="+h;window.location.href=i}return!1})});